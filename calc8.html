<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>祝 驻 -  住驻专</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
        }

        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 90%;
            border-top: 6px solid #4a90e2;
        }

        h1 { color: #2c3e50; margin-bottom: 0.5rem; }
        h2 { color: #34495e; font-size: 1.2rem; }

        /* 住 转驻专 专砖 */
        .grid-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .menu-btn {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 20px;
            font-size: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 4px 0 #357abd;
        }

        .menu-btn:hover { background-color: #357abd; transform: translateY(-2px); }
        .menu-btn:active { transform: translateY(2px); box-shadow: none; }

        /* 住 砖拽 */
        .score-board {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 1.5rem;
            background: #f5f5f5;
            padding: 5px 15px;
            border-radius: 15px;
            display: inline-block;
        }

        .question-box {
            font-size: 1.6rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2c3e50;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.4;
        }

        input[type="number"] {
            font-size: 1.5rem;
            padding: 10px;
            width: 100px;
            text-align: center;
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            margin-bottom: 15px;
            outline: none;
        }
        
        input[type="number"]:focus { border-color: #4a90e2; }

        .action-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 5px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .action-btn:hover { background-color: #27ae60; }
        .secondary-btn { background-color: #e67e22; }
        .secondary-btn:hover { background-color: #d35400; }
        .home-btn { background-color: #95a5a6; margin-top: 20px; font-size: 1rem;}
        .home-btn:hover { background-color: #7f8c8d; }

        .message {
            margin-top: 15px;
            font-size: 1.3rem;
            height: 30px;
            font-weight: bold;
        }

        .correct { color: #27ae60; }
        .wrong { color: #c0392b; }
        .hidden { display: none; }

    </style>
</head>
<body>

<div class="container">
    
    <div id="menu-screen">
        <h1>转专 转  驻 </h1>
        <h2>专 住驻专  转 :</h2>
        <div class="grid-menu">
            <button class="menu-btn" onclick="startTest(1)">1</button>
            <button class="menu-btn" onclick="startTest(2)">2</button>
            <button class="menu-btn" onclick="startTest(3)">3</button>
            <button class="menu-btn" onclick="startTest(4)">4</button>
            <button class="menu-btn" onclick="startTest(5)">5</button>
            <button class="menu-btn" onclick="startTest(6)">6</button>
            <button class="menu-btn" onclick="startTest(7)">7</button>
            <button class="menu-btn" onclick="startTest(8)">8</button>
            <button class="menu-btn" onclick="startTest(9)">9</button>
            <button class="menu-btn" onclick="startTest(10)">10</button>
        </div>
    </div>

    <div id="game-screen" class="hidden">
        <h1 id="game-title">驻转 砖 X</h1>
        <div class="score-board">
            砖 <span id="current-q-num">0</span> 转 <span id="total-q-num">30</span>
        </div>

        <div class="question-box" id="question-text"></div>
        <input type="number" id="answer-input" placeholder="?" autocomplete="off">
        <br>
        <button onclick="checkAnswer()" id="check-btn" class="action-btn">拽</button>
        <div class="message" id="feedback-msg"></div>
        <button onclick="nextQuestion()" id="next-btn" class="action-btn secondary-btn hidden">砖 </button>
        
        <br>
        <button onclick="showMenu()" class="action-btn home-btn">专 转驻专</button>
    </div>

    <div id="end-screen" class="hidden">
        <h2> ! 住转 转 ! </h2>
        <p>转 砖 驻转 砖 <span id="finished-number"></span>!</p>
        <button onclick="showMenu()" class="action-btn">专 住驻专 专</button>
        <button onclick="restartSameTest()" class="action-btn secondary-btn">转 砖</button>
    </div>

</div>

<script>
    let questions = [];
    let remainingQuestions = [];
    let currentQuestion = null;
    let questionCounter = 0;
    let currentBaseNum = 0;

    // 转转 砖转 转  砖转  住驻专
    function generateWordProblems(base, type) {
        // type 'mult' = 砖转 驻
        // type 'div' = 砖转 拽/砖
        
        // 专 住驻专 专 驻 ( 2 -9)  
        const rand = () => Math.floor(Math.random() * 8) + 2; 

        if (type === 'mult') {
            const m1 = rand(); const m2 = rand(); const m3 = rand(); const m4 = rand(); const m5 = rand();
            return [
                { text: `转 拽转 注 ${base} 砖拽.  注 ${m1} 转?`, answer: base * m1 },
                { text: ` 拽驻住 砖 ${base} 专.  拽 ${m2} 拽驻住转.  专 砖 ?`, answer: base * m2 },
                { text: `专 拽专转 ${base} 注 .  注 转拽专 -${m3} ?`, answer: base * m3 },
                { text: `  砖 ${base} 拽转. 砖  ${m4}  .  拽转 住"?`, answer: base * m4 },
                { text: ` 注 爪专 ${base} 爪.  爪 爪专 -${m5} 注转?`, answer: base * m5 }
            ];
        } else { // div
            //  爪专 砖转爪 转 驻, 转砖  专 住专
            const d1 = rand(); const d2 = rand(); const d3 = rand(); const d4 = rand(); const d5 = rand();
            return [
                { text: `拽转 ${base * d1} 住专转 砖 砖 -${base} .  住专转 拽  ?`, answer: d1 },
                { text: `住驻专 注 ${base} 砖拽. 砖转 住  ${base * d2} 砖拽.  住驻专 拽转?`, answer: d2 },
                { text: `砖  ${base * d3} 转转  拽 ${base}  注 .  注 爪专?`, answer: d3 },
                { text: `爪专 爪注 住" ${base * d4} 拽专.   ${base} 拽" ,    拽?`, answer: d4 },
                { text: `转 砖 ${base * d5} 转 专 住专 转 砖专转 砖 ${base}.  砖专转 砖?`, answer: d5 }
            ];
        }
    }

    function generateQuestionsForNumber(num) {
        const qList = [];
        
        // 1. 注砖专 砖转 驻转 驻砖转 (1-10)
        for (let i = 1; i <= 10; i++) {
            qList.push({
                text: `${num}  ${i} = ?`,
                answer: num * i
            });
        }

        // 2. 注砖专 砖转 砖 (1-10)
        for (let i = 1; i <= 10; i++) {
            const product = i * num;
            qList.push({
                text: `${num}  _ = ${product}`,
                answer: i
            });
        }

        // 3. 住驻转 砖转 转 转
        const multProblems = generateWordProblems(num, 'mult');
        const divProblems = generateWordProblems(num, 'div');

        return qList.concat(multProblems, divProblems);
    }

    function showMenu() {
        document.getElementById('menu-screen').classList.remove('hidden');
        document.getElementById('game-screen').classList.add('hidden');
        document.getElementById('end-screen').classList.add('hidden');
    }

    function startTest(num) {
        currentBaseNum = num;
        document.getElementById('game-title').innerText = "转专 驻转 砖 " + num;
        
        document.getElementById('menu-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        document.getElementById('end-screen').classList.add('hidden');
        
        restartSameTest();
    }

    function restartSameTest() {
        document.getElementById('end-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        
        questions = generateQuestionsForNumber(currentBaseNum);
        remainingQuestions = [...questions]; 
        questionCounter = 0;
        
        document.getElementById('total-q-num').innerText = questions.length;
        document.getElementById('finished-number').innerText = currentBaseNum;
        
        nextQuestion();
    }

    function nextQuestion() {
        document.getElementById('feedback-msg').innerText = '';
        document.getElementById('next-btn').classList.add('hidden');
        document.getElementById('check-btn').classList.remove('hidden');
        document.getElementById('answer-input').value = '';
        document.getElementById('answer-input').focus();

        if (remainingQuestions.length === 0) {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('end-screen').classList.remove('hidden');
            return;
        }

        const randomIndex = Math.floor(Math.random() * remainingQuestions.length);
        currentQuestion = remainingQuestions[randomIndex];
        remainingQuestions.splice(randomIndex, 1);

        questionCounter++;
        document.getElementById('current-q-num').innerText = questionCounter;
        document.getElementById('question-text').innerText = currentQuestion.text;
    }

    function checkAnswer() {
        const input = document.getElementById('answer-input');
        const userAnswer = parseInt(input.value);
        const feedback = document.getElementById('feedback-msg');

        if (isNaN(userAnswer)) {
            feedback.innerText = " 转 住驻专";
            feedback.className = "message wrong";
            return;
        }

        if (userAnswer === currentQuestion.answer) {
            feedback.innerText = "注!  ! ";
            feedback.className = "message correct";
            document.getElementById('check-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');
            document.getElementById('next-btn').focus();
        } else {
            feedback.innerText = " 拽. 住 砖 ";
            feedback.className = "message wrong";
            input.value = '';
            input.focus();
        }
    }

    document.getElementById('answer-input').addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            if (!document.getElementById('check-btn').classList.contains('hidden')) {
                checkAnswer();
            } else {
                nextQuestion();
            }
        }
    });

</script>

</body>
</html>